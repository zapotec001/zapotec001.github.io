{% extends "base.html" %}

{% block title %}Tarihte Bugün - Bugün Neler Oldu?{% endblock %}

{% block content %}
<section class="hero" data-animate>
  <div class="hero__content">
    <p class="hero__eyebrow">{{ today_label }}</p>
    <h1>Tarihte Bugün Neler Oldu?</h1>
    <p class="hero__lead">
      Türkçe Wikipedia kayıtlarından derlenen öne çıkan olayları her gün şeffaf
      bir tasarımda sunuyoruz. Yönetim paneliyle içerikleri dilediğiniz gibi
      düzenleyebilir, yeni detaylar ekleyebilirsiniz.
    </p>
    <div class="hero__meta">
      {% if last_refreshed_human %}
      <span class="meta-item">
        <strong>Son güncelleme:</strong>
        <span>{{ last_refreshed_human }}</span>
      </span>
      {% endif %}
      <span class="meta-item">
        <strong>İçerik sayısı:</strong>
        <span>{{ events|length }}</span>
      </span>
      <span class="meta-item">
        <strong>Şu an saat:</strong>
        <span data-clock aria-live="polite">--:--</span>
      </span>
    </div>
    <div class="hero__actions">
      <a class="button" href="#icerikler">Olayları keşfet</a>
      <a class="button button--ghost" href="{{ url_for('admin_login') }}">
        Yönetim girişi
      </a>
    </div>
  </div>
</section>

<section class="events" id="icerikler">
  <div class="section-heading" data-animate>
    <h2>Bugünün Öne Çıkanları</h2>
    <p>
      Aşağıdaki içerikler otomatik olarak Wikipedia’dan alınır ve yönetici
      panelinden düzenlenebilir. Uzun metinler filtrelenir, bağlantılar temizlenir
      ve mümkün olduğunda görseller eklenir.
    </p>
  </div>

  {% if events %}
  <div class="events__grid">
    {% for event in events %}
    <article class="event-card glass" data-animate>
      <header class="event-card__header">
        <span class="event-card__badge">{{ event.category_label }}</span>
        {% if event.year %}
        <span class="event-card__year">{{ event.year }}</span>
        {% endif %}
      </header>

      {% if event.image_url %}
      <figure class="event-card__figure">
        <img src="{{ event.image_url }}" alt="{{ event.title }}" loading="lazy" />
        {% if event.image_caption %}
        <figcaption>{{ event.image_caption }}</figcaption>
        {% endif %}
      </figure>
      {% endif %}

      <div class="event-card__body">
        <h3>{{ event.title }}</h3>
        <p>{{ event.summary }}</p>
        {% if event.date_label %}
        <p class="event-card__date">{{ event.date_label }}</p>
        {% endif %}
      </div>

      <footer class="event-card__footer">
        {% if event.source_url %}
        <a class="button button--link" href="{{ event.source_url }}" target="_blank" rel="noopener">
          {{ event.source_title or 'Wikipedia kaynağı' }}
        </a>
        {% endif %}
        {% if event.image_credit_url and event.image_credit_url != event.source_url %}
        <a class="button button--link" href="{{ event.image_credit_url }}" target="_blank" rel="noopener">
          Görsel kaynağı
        </a>
        {% endif %}
      </footer>
    </article>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state glass" data-animate>
    <h3>Henüz içerik bulunamadı</h3>
    <p>
      Yönetim paneline giriş yapıp “Bugünün Olaylarını Yenile” düğmesiyle güncel
      haberleri yükleyebilir veya özel içerikler ekleyebilirsiniz.
    </p>
    <a class="button" href="{{ url_for('admin_login') }}">Yönetim paneline git</a>
  </div>
  {% endif %}
</section>
{% endblock %}
